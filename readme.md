# ICP 批量备案信息查询工具

## 项目简介

本工具用于批量查询单位（公司）的网站、APP、小程序备案信息，并将结果输出到 Excel 文件。支持代理、重试、目标去重、类型多选、彩色日志输出等功能。

---

## 环境准备

- Go 1.18 及以上版本
- Windows/Linux/MacOS

---

## 自行编译

在项目根目录下执行：

```
go mod tidy
go build -ldflags="-s -w" -trimpath -o icpsearch.exe main.go
```


## 命令行参数说明

| 参数   | 说明                                         | 示例                                  |
|--------|----------------------------------------------|---------------------------------------|
| -t     | 目标单位名或文件（必填）                     | -t targets.txt 或 -t "公司名"         |
| -type  | 类型：1=网站,2=APP,3=小程序，可组合，默认1    | -type 1,2,3                           |
| -o     | 输出Excel文件名，默认 result.xlsx             | -o 1.xlsx                             |
| -p     | 代理地址，支持 http/https/socks5（可选）      | -p socks5://127.0.0.1:1080            |

---

## 使用方法

### 1. 直接查询单个单位

```
icpsearch.exe -t "公司名称"
```

### 2. 批量查询（文件每行一个单位名，支持括号拆分）

```
icpsearch.exe -t targets.txt -type 1,2,3 -o 结果.xlsx
```

### 3. 使用代理

```
这里直接推荐使用JackProxy这个工具，经过测试125个单位查询域名备案，app，小程序全部查询结束依旧有可用代理足以覆盖平时攻防演练情况下信息收集
项目地址：https://github.com/YingxueSec/JackProxy-Pro
获取token后使用  JackProxy-Pro.exe -token  xxxxxxxxxxxx  即可在127.0.0.1:33333  开启socks5代理
icp查询 直接执行命令    icpsearch.exe -t targets.txt -p socks5://127.0.0.1:33333  即可查询相关信息
---

## 功能说明

- 支持多类型查询：网站、APP、小程序可任意组合。
- 支持目标去重：同名单位只查一次。
- 支持括号拆分：如"公司A(别名A)"会拆成"公司A"和"别名A"两个目标。
- 自动重试：接口失败自动重试最多5次。
- 支持代理：可通过 http/https/socks5 代理访问。
- 彩色日志输出：查询进度、失败、结果均有颜色区分，便于快速定位。


## 示例

#### 输入文件 `targets.txt`：

```
公司A
公司B(别名B)
公司C
```

#### 运行命令：

```
icpsearch.exe -t targets.txt -type 1,2,3 -o result.xlsx
```

#### 终端输出（示例）：

```
[1/3] 正在查询单位：公司A
[查询结果] 公司A
  网站: example.com
  APP: 无备案
  小程序: 无备案

[2/3] 正在查询单位：别名B
❌ 查询失败 [别名B][网站]: ...
[单位查询失败] 别名B

[3/3] 正在查询单位：公司C
[查询结果] 公司C
  网站: 无备案
  APP: 无备案
  小程序: 无备案
```

#### Excel 输出（result.xlsx）：

| 公司名 | 网站 | APP | 小程序 | 未备案公司名 | 查询失败公司名 |
|--------|------|-----|--------|--------------|----------------|
| 公司A  | ...  |     |        |              |                |
| 别名B  |      |     |        |              | 别名B          |
| 公司C  |      |     |        | 公司C        |                |

---

## 常见问题

- **代理无法连接**：请检查代理地址和端口是否正确，或尝试不用代理。
- **Excel 无法打开**：请确保输出文件未被占用，或更换输出文件名。

---

如有其他问题或定制需求，请联系开发者。
